(function(){ try {var elementStyle = document.createElement('style'); elementStyle.appendChild(document.createTextNode(".voice.svelte-s4ai01{width:90vw;margin:.3rem .15rem;line-height:.33rem}.voice-btn.svelte-s4ai01{display:flex;align-items:center;flex-shrink:0;padding:.02rem .08rem;margin-right:.08rem}.voice-btn-img.svelte-s4ai01{height:.33rem!important;width:.33rem!important;margin:0 .08rem}.voice-btn-text.svelte-s4ai01{font-size:.24rem}.voice-canvas.svelte-s4ai01{position:relative;display:flex;height:.33rem;overflow:hidden;margin:.06rem 0;flex:1}.voice-time.svelte-s4ai01{flex-shrink:0;padding:0 .2rem}.container.svelte-s4ai01{display:flex;align-items:center;justify-content:space-between;border-radius:.3rem;border-width:.01rem;-webkit-box-pack:justify;border-style:solid;height:.6rem}.light-bd.svelte-s4ai01{border-color:#f5f5f5}[theme-mode=black] .light-bd.svelte-s4ai01{border-color:#202022}")); document.head.appendChild(elementStyle);} catch(e) {console.error('vite-plugin-css-injected-by-js', e);} })();(function(B,I){typeof exports=="object"&&typeof module<"u"?I(exports):typeof define=="function"&&define.amd?define(["exports"],I):(B=typeof globalThis<"u"?globalThis:B||self,I(B.audioPlayer={}))})(this,function(B){"use strict";var I=document.createElement("style");I.textContent=`.voice.svelte-s4ai01{width:90vw;margin:.3rem .15rem;line-height:.33rem}.voice-btn.svelte-s4ai01{display:flex;align-items:center;flex-shrink:0;padding:.02rem .08rem;margin-right:.08rem}.voice-btn-img.svelte-s4ai01{height:.33rem!important;width:.33rem!important;margin:0 .08rem}.voice-btn-text.svelte-s4ai01{font-size:.24rem}.voice-canvas.svelte-s4ai01{position:relative;display:flex;height:.33rem;overflow:hidden;margin:.06rem 0;flex:1}.voice-time.svelte-s4ai01{flex-shrink:0;padding:0 .2rem}.container.svelte-s4ai01{display:flex;align-items:center;justify-content:space-between;border-radius:.3rem;border-width:.01rem;-webkit-box-pack:justify;border-style:solid;height:.6rem}.light-bd.svelte-s4ai01{border-color:#f5f5f5}[theme-mode=black] .light-bd.svelte-s4ai01{border-color:#202022}
`,document.head.appendChild(I);function D(){}function K(e){return e()}function Q(){return Object.create(null)}function W(e){e.forEach(K)}function U(e){return typeof e=="function"}function ue(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let q;function de(e,t){return q||(q=document.createElement("a")),q.href=t,e===q.href}function he(e){return Object.keys(e).length===0}function w(e,t){e.appendChild(t)}function ge(e,t,n){const i=me(e);if(!i.getElementById(t)){const s=E("style");s.id=t,s.textContent=n,pe(i,s)}}function me(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function pe(e,t){return w(e.head||e,t),t.sheet}function Z(e,t,n){e.insertBefore(t,n||null)}function V(e){e.parentNode&&e.parentNode.removeChild(e)}function E(e){return document.createElement(e)}function H(e){return document.createTextNode(e)}function X(){return H(" ")}function ve(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function x(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function _e(e){return Array.from(e.childNodes)}function $(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function be(e,t,{bubbles:n=!1,cancelable:i=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,n,i,t),s}let O;function F(e){O=e}function ee(){if(!O)throw new Error("Function called outside component initialization");return O}function we(e){ee().$$.on_mount.push(e)}function ye(){const e=ee();return(t,n,{cancelable:i=!1}={})=>{const s=e.$$.callbacks[t];if(s){const c=be(t,n,{cancelable:i});return s.slice().forEach(a=>{a.call(e,c)}),!c.defaultPrevented}return!0}}const M=[],R=[],L=[],te=[],xe=Promise.resolve();let Y=!1;function ke(){Y||(Y=!0,xe.then(ne))}function A(e){L.push(e)}const G=new Set;let z=0;function ne(){if(z!==0)return;const e=O;do{try{for(;z<M.length;){const t=M[z];z++,F(t),Se(t.$$)}}catch(t){throw M.length=0,z=0,t}for(F(null),M.length=0,z=0;R.length;)R.pop()();for(let t=0;t<L.length;t+=1){const n=L[t];G.has(n)||(G.add(n),n())}L.length=0}while(M.length);for(;te.length;)te.pop()();Y=!1,G.clear(),F(e)}function Se(e){if(e.fragment!==null){e.update(),W(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}const Ce=new Set;function ie(e,t){e&&e.i&&(Ce.delete(e),e.i(t))}function Ee(e,t){e.d(1),t.delete(e.key)}function Ne(e,t,n,i,s,c,a,f,y,h,b,v){let g=e.length,o=c.length,u=g;const P={};for(;u--;)P[e[u].key]=u;const _=[],T=new Map,k=new Map;for(u=o;u--;){const l=v(s,c,u),d=n(l);let m=a.get(d);m?i&&m.p(l,t):(m=h(d,l),m.c()),T.set(d,_[u]=m),d in P&&k.set(d,Math.abs(u-P[d]))}const C=new Set,N=new Set;function S(l){ie(l,1),l.m(f,b),a.set(l.key,l),b=l.first,o--}for(;g&&o;){const l=_[o-1],d=e[g-1],m=l.key,j=d.key;l===d?(b=l.first,g--,o--):T.has(j)?!a.has(m)||C.has(m)?S(l):N.has(j)?g--:k.get(m)>k.get(j)?(N.add(m),S(l)):(C.add(j),g--):(y(d,a),g--)}for(;g--;){const l=e[g];T.has(l.key)||y(l,a)}for(;o;)S(_[o-1]);return _}function Pe(e,t,n,i){const{fragment:s,after_update:c}=e.$$;s&&s.m(t,n),i||A(()=>{const a=e.$$.on_mount.map(K).filter(U);e.$$.on_destroy?e.$$.on_destroy.push(...a):W(a),e.$$.on_mount=[]}),c.forEach(A)}function Te(e,t){const n=e.$$;n.fragment!==null&&(W(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function je(e,t){e.$$.dirty[0]===-1&&(M.push(e),ke(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Be(e,t,n,i,s,c,a,f=[-1]){const y=O;F(e);const h=e.$$={fragment:null,ctx:[],props:c,update:D,not_equal:s,bound:Q(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(y?y.$$.context:[])),callbacks:Q(),dirty:f,skip_bound:!1,root:t.target||y.$$.root};a&&a(h.root);let b=!1;if(h.ctx=n?n(e,t.props||{},(v,g,...o)=>{const u=o.length?o[0]:g;return h.ctx&&s(h.ctx[v],h.ctx[v]=u)&&(!h.skip_bound&&h.bound[v]&&h.bound[v](u),b&&je(e,v)),g}):[],h.update(),b=!0,W(h.before_update),h.fragment=i?i(h.ctx):!1,t.target){if(t.hydrate){const v=_e(t.target);h.fragment&&h.fragment.l(v),v.forEach(V)}else h.fragment&&h.fragment.c();t.intro&&ie(e.$$.fragment),Pe(e,t.target,t.anchor,t.customElement),ne()}F(y)}class Ie{$destroy(){Te(this,1),this.$destroy=D}$on(t,n){if(!U(n))return D;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const s=i.indexOf(n);s!==-1&&i.splice(s,1)}}$set(t){this.$$set&&!he(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Me=e=>e.replace(/<span class="sp-parent(.*?)><span class="sp-robot(.*?)<\/span><\/span>/g,"").replace(/<script\b[^>]*>[\s\S]*<\/script>/g,"").replace(/\s{2,}/g,"").replace(/[\r\n]/g,"").replace(/<img[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp/g,"&").replace(/&;/g,"&").replace(/<table(.*?)<\/table>/g,"").replace(/<style(.*?)<\/style>/g,"").replace(/表格支持左右滑动/g,"").replace(/<[^>]*[^/]>/gi,"").replace(/>{1,}/g,"").replace(/&gt;/g,"").replace(/_{2,}/g,""),se=(e,t)=>{const n=[];let i=e.indexOf(t);for(;i>-1;)n.push(e.slice(0,i+1)),e=e.slice(i+1),i=e.indexOf(t);return e&&n.push(e),n},ze=(e,t)=>se(e,"\u3002").map(n=>(n.indexOf("\uFF1B")>-1&&(n=se(n,"\uFF1B")),n)).reduce((n,i)=>(t(i)==="array"?n=[...n,...i]:n.push(i),n),[]),De=({strArr:e,clientNum:t,result:n,i})=>{let s="";for(;e[i].length>t;)s=e[i].slice(0,t-1),e[i]=e[i].slice(t-1),s&&n.push(s),s="";return e[i+1]?e[i+1]=e[i]+e[i+1]:(s=e[i],s&&n.push(s)),{strArr:e,result:n}},He=({strArr:e,i:t,clientNum:n,result:i})=>{let s="";if(s=e[t],(s+e[t+1]).length<n)for(;s.length<n&&e[t+1];)s=s+e[t+1],t++;return s&&i.push(s),{result:i,strArr:e,i:t}},Oe=e=>{const n=a=>Object.prototype.toString.call(a).slice(8,-1).toLowerCase();let i=[],s=ze(e,n);const c=512;for(let a=0;a<s.length;a++)if(s[a].length>c){const f=De({strArr:s,clientNum:c,result:i,i:a});s=f.strArr,i=f.result}else{const f=He({strArr:s,i:a,clientNum:c,result:i});s=f.strArr,i=f.result,a=f.i}return i},Fe=e=>{const t=Me(e);return{origniformatData:Oe(t),dataLength:t.length}},Qe="";function We(e){ge(e,"svelte-s4ai01",".voice.svelte-s4ai01{width:90vw;margin:0.3rem 0.15rem;line-height:0.33rem}.voice-btn.svelte-s4ai01{display:flex;align-items:center;flex-shrink:0;padding:0.02rem 0.08rem;margin-right:0.08rem}.voice-btn-img.svelte-s4ai01{height:0.33rem !important;width:0.33rem !important;margin:0 0.08rem}.voice-btn-text.svelte-s4ai01{font-size:0.24rem}.voice-canvas.svelte-s4ai01{position:relative;display:flex;height:0.33rem;overflow:hidden;margin:0.06rem 0;flex:1}.voice-time.svelte-s4ai01{flex-shrink:0;padding:0 0.2rem}.container.svelte-s4ai01{display:flex;align-items:center;justify-content:space-between;border-radius:0.3rem;border-width:0.01rem;-webkit-box-pack:justify;border-style:solid;height:0.6rem}.light-bd.svelte-s4ai01{border-color:#f5f5f5}[theme-mode='black'] .light-bd.svelte-s4ai01{border-color:#202022}")}function le(e,t,n){const i=e.slice();return i[30]=t[n],i[32]=n,i}function ae(e,t){let n,i,s;return{key:e,first:null,c(){n=E("img"),x(n,"class","voice-btn-img svelte-s4ai01"),de(n.src,i=t[30])||x(n,"src",i),x(n,"alt",""),x(n,"style",s=`display:${t[1]===t[32]?"inline":"none"}`),this.first=n},m(c,a){Z(c,n,a)},p(c,a){t=c,a[0]&2&&s!==(s=`display:${t[1]===t[32]?"inline":"none"}`)&&x(n,"style",s)},d(c){c&&V(n)}}}function qe(e){let t,n,i,s=[],c=new Map,a,f,y,h,b,v,g,o,u,P,_,T,k,C,N=e[5];const S=l=>l[30];for(let l=0;l<N.length;l+=1){let d=le(e,N,l),m=S(d);c.set(m,s[l]=ae(m,d))}return{c(){t=E("div"),n=E("div"),i=E("div");for(let l=0;l<s.length;l+=1)s[l].c();a=X(),f=E("div"),y=H(e[0]),h=X(),b=E("div"),v=E("canvas"),g=X(),o=E("div"),u=E("div"),P=H("\u7EA6"),_=H(e[2]),T=H("\u5206\u949F"),x(f,"class","voice-btn-text sub-text-gray svelte-s4ai01"),x(i,"class","voice-btn svelte-s4ai01"),x(v,"id","canvas"),x(b,"class","voice-canvas svelte-s4ai01"),x(u,"class","voice-btn-text sub-text-gray svelte-s4ai01"),x(o,"class","voice-time svelte-s4ai01"),x(n,"class","container light-bd svelte-s4ai01"),x(t,"class","voice svelte-s4ai01")},m(l,d){Z(l,t,d),w(t,n),w(n,i);for(let m=0;m<s.length;m+=1)s[m].m(i,null);w(i,a),w(i,f),w(f,y),w(n,h),w(n,b),w(b,v),e[12](v),e[13](b),w(n,g),w(n,o),w(o,u),w(u,P),w(u,_),w(u,T),k||(C=ve(t,"click",e[6]),k=!0)},p(l,d){d[0]&34&&(N=l[5],s=Ne(s,d,S,1,l,N,c,i,Ee,ae,a,le)),d[0]&1&&$(y,l[0]),d[0]&4&&$(_,l[2])},i:D,o:D,d(l){l&&V(t);for(let d=0;d<s.length;d+=1)s[d].d();e[12](null),e[13](null),k=!1,C()}}}function Re(e,t,n){const i=ye();let{seq:s=""}=t,{title:c=""}=t,{content:a=""}=t,{statPageId:f=""}=t,{btnText:y="\u542C\u8D22\u7ECF"}=t;const h=["//i.thsi.cn/webprivate/voicebroadcast/play.png","//i.thsi.cn/webprivate/voicebroadcast/playN.png","//i.thsi.cn/webprivate/voicebroadcast/pause.png","//i.thsi.cn/webprivate/voicebroadcast/pauseN.png"];let b=2,v=1,g,o,u,P,_=!1,T,k=[5,7,5,11,7,5,7,9,11,7,9,5,7,5,3,7,5,7,3,9,7,11,7,5,7,3,9,7,5,9],C=0,N=0,S=!1,l=0;const d=()=>{const r=window.devicePixelRatio||1;u=o.getContext("2d"),n(4,o.style.width=`${g.offsetWidth}px`,o),n(4,o.style.height=`${g.offsetHeight}px`,o),n(4,o.width=g.offsetWidth*r,o),n(4,o.height=g.offsetHeight*r,o),C=o.width*(2/(30*2+29*5)),N=o.width*(5/(30*2+29*5.05)),k=k.map(p=>({volume:p,increase:p<=7})),m(!0)},m=r=>{u.clearRect(0,0,o.width,o.height),k.forEach((p,J)=>{const{volume:Ke}=p,re=o.height*(Ke/17),ce=J*(C+N)+C/2+1,fe=(o.height-re)/2;u.beginPath(),u.arc(ce,fe,C/2,0,Math.PI,!0),u.arc(ce,fe+re,C/2,-Math.PI,0,!0),u.fillStyle=window.getCssStyle()==="black"?"rgba(253, 67, 50, .5)":"rgba(233, 48, 48, .5)",u.fill()}),r||(k=k.map(p=>(p.increase?p.volume+=.3:p.volume-=.3,p.volume>=11?p.increase=!1:p.volume<=2&&(p.increase=!0),p)),T=window.requestAnimationFrame(m.bind(this,!1)))},j=()=>{window.cancelAnimationFrame(T)},Ve=()=>{_?Ye():S?Ae():Xe()},Xe=()=>{window.callNativeHandler("zxVoiceBroadcast",{seq:s,title:c,state:1,content:P})},Ye=()=>{window.callNativeHandler("zxVoiceBroadcast",{seq:s,state:2})},Ae=()=>{window.callNativeHandler("zxVoiceBroadcast",{seq:s,state:3})},oe=r=>{const p=()=>(l||(l=+(window.localStorage.getItem(s)||0)),{targid:`bt_${l}`});switch(r){case 0:S=!1,_&&(n(11,_=!1),i("onplayover"),j()),f&&window.hxmClickStat(`${f}.over`,p());break;case 1:n(11,_=!0),S=!0,m(!1),i("ondisplay"),l=new Date().getTime(),window.localStorage.setItem(s,String(l)),f&&window.hxmClickStat(`${f}.start`,p());break;case 2:n(11,_=!1),S=!0,j(),i("onpause"),f&&window.hxmClickStat(`${f}.pause`,p());break;case 3:n(11,_=!0),S=!0,m(!1),i("oncontinue"),f&&window.hxmClickStat(`${f}.continue`,p());break}};we(()=>{window.callNativeHandler("NotifyNativeEventToWeb",""),window.registerWebHandler("NotifyNativeEventToWeb",r=>{r.key==="zx_tts_stop"&&oe(+r.result.code)}),window.registerWebHandler("zxVoiceBroadcast",r=>{oe(+r.state)}),setTimeout(()=>{d(),window.callNativeHandler("zxVoiceBroadcast",{seq:s,state:4},()=>{})})});function Ge(r){R[r?"unshift":"push"](()=>{o=r,n(4,o)})}function Je(r){R[r?"unshift":"push"](()=>{g=r,n(3,g)})}return e.$$set=r=>{"seq"in r&&n(7,s=r.seq),"title"in r&&n(8,c=r.title),"content"in r&&n(9,a=r.content),"statPageId"in r&&n(10,f=r.statPageId),"btnText"in r&&n(0,y=r.btnText)},e.$$.update=()=>{if(e.$$.dirty[0]&2048&&(window.getCssStyle()==="black"?n(1,b=_?3:1):n(1,b=_?2:0)),e.$$.dirty[0]&512){const{dataLength:p,origniformatData:J}=Fe(a);P=J,n(2,v=Math.ceil(p/300))}},[y,b,v,g,o,h,Ve,s,c,a,f,_,Ge,Je]}class Le extends Ie{constructor(t){super(),Be(this,t,Re,qe,ue,{seq:7,title:8,content:9,statPageId:10,btnText:0},We,[-1,-1])}}B.AudioComponent=Le,Object.defineProperties(B,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
